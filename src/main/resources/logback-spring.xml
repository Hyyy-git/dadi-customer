<?xml version="1.0" encoding="UTF-8"?>
<configuration debug="false" scan="true" scanPeriod="60 seconds">
	<include resource="org/springframework/boot/logging/logback/defaults.xml" />

	<property name="PROJECT_NAME" value="gd-customer" />
	<property name="LOG_DIR" value="/app/${PROJECT_NAME}/logs"/>
	<property name="fileLayoutPattern" value="%d{yyyy-MM-dd HH:mm:ss.SSS} [%.40thread@%T][%.-1level] %logger{40}:%L - %msg%n" />

	<appender name="INFO_FILE" class="ch.qos.logback.core.rolling.RollingFileAppender">
		<file>${LOG_DIR}/${PROJECT_NAME}.log</file>
		<rollingPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy">
			<fileNamePattern>${LOG_DIR}/${PROJECT_NAME}_%d{yyyy-MM-dd}_%i.log.zip</fileNamePattern>
			<maxFileSize>100MB</maxFileSize>
			<totalSizeCap>10GB</totalSizeCap>
			<maxHistory>90</maxHistory>
		</rollingPolicy>
		<encoder>
			<pattern>${fileLayoutPattern}</pattern>
			<charset>UTF-8</charset>
		</encoder>
	</appender>

	<appender name="ERROR_FILE" class="ch.qos.logback.core.rolling.RollingFileAppender">
		<filter class="ch.qos.logback.classic.filter.LevelFilter">
			<level>ERROR</level>
			<onMatch>ACCEPT</onMatch>
			<onMismatch>DENY</onMismatch>
		</filter>
		<!-- 正在记录的日志文档的路径及文档名 -->
		<file>${LOG_DIR}/${PROJECT_NAME}-error.log</file>
		<rollingPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy">
			<fileNamePattern>${LOG_DIR}/${PROJECT_NAME}_%d{yyyy-MM-dd}_%i-error.log.zip</fileNamePattern>
			<maxFileSize>100MB</maxFileSize>
			<totalSizeCap>5GB</totalSizeCap>
			<maxHistory>90</maxHistory>
		</rollingPolicy>
		<encoder>
			<pattern>${fileLayoutPattern}</pattern>
			<charset>UTF-8</charset>
		</encoder>
	</appender>

	<springProfile name="dev">
		<include resource="logback-dev.xml"/>
	</springProfile>

	<springProfile name="sit">
		<include resource="logback-sit.xml"/>
	</springProfile>

	<springProfile name="uat">
		<include resource="logback-uat.xml"/>
	</springProfile>

	<springProfile name="prd">
		<include resource="logback-prd.xml"/>
	</springProfile>

</configuration>